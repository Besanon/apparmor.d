abi <abi/3.0>,

include <tunables/global>

profile loopback /{opt/,}{cni/,}bin/loopback {
  include <abstractions/base>

  /opt/cni/bin/loopback rix,
  
  /sys/kernel/mm/transparent_hugepage/hpage_pmd_size r,

  include if exists <local/loopback>
}

profile portmap /{opt/,}{cni/,}bin/portmap {
  include <abstractions/base>

  /opt/cni/bin/portmap rix,
  
  /sys/kernel/mm/transparent_hugepage/hpage_pmd_size r,

  include if exists <local/portmap>
}

profile bandwidth /{opt/,}{cni/,}bin/bandwidth {
  include <abstractions/base>

  /opt/cni/bin/bandwidth rix,
  
  network inet,
  network netlink raw,
  /sys/kernel/mm/transparent_hugepage/hpage_pmd_size r,

  include if exists <local/bandwidth>
}
